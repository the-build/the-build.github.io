{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/ComputerScience/maximum-inqury-count-of-opensearch/","result":{"pageContext":{"article":{"banner":{"alt":"","caption":"","src":null},"body":"<blockquote>\n<h2>💡  <strong>Situation</strong></h2>\n</blockquote>\n<ul>\n<li>\n<p>APM 제품의 application 로그를 시계열 데이터로 적재하고있다.</p>\n</li>\n<li>\n<p>게시판 형태의 페이지에서, 페이지네이션이 가능한 검색이 필요하다.</p>\n</li>\n<li>\n<p>1만건이 넘을 때 페이지를 불러올 수 없다.</p>\n</li>\n</ul>\n<blockquote>\n<h2>📋 <strong>Task</strong></h2>\n</blockquote>\n<ul>\n<li>OpenSearch의 공식 문서를 읽고 제약사항과 대안을 확인한다.</li>\n<li>부족하면 구글링하여 다른 use case를 파악한다.</li>\n<li>위 두가지 내용을 gpt 통해 좋은 방법을 확인 후 채택한다.</li>\n<li>테스트 코드 작성하여, 의도한 대로 되는지 시도해본다.</li>\n</ul>\n<blockquote>\n<h2>👨‍💻 <strong>Action</strong></h2>\n</blockquote>\n<ul>\n<li>\n<p>OpenSearch 문서 확인 <br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.84848484848485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABzklEQVR42m2R207bQBCG8/7v0aoUSouqXlD1BQoShRIMJAQHJ/H6sD7t+hTbydeJ2xvarvRp7D3888/M5O3pF05OP3N88nHk5MMn4YxjiQeOjo55/+4NcZLiaUOUWwprCdMM2zRUbUspcTsM+EHApO0G+j3jand7TNUxbAf23Q4G2AUrho1LI3tnlx7fbtaUVUlaFP8XLEwlIlts1aKymjtnxexxxpVzw8P8gflige969FnOKrHE4tBWFbauR0rByH/TdaiDoC0lSzPQtD3abJlt5GGUEKQJ1srFuqNpevqmZa00RVWTm0PZ5Sg0OqwbumFHFMWvBeOi5Tm0BLnBUS94aURY5CRlSS/tWAUpWZKPYipORgKdEkp/jYjGWjMxfwk+BQYlDV9qxSbTqDwlNkYcDONQcklW5wWpkFkzurR/Sg6j6F+HblTixgHXq0fmoceLDgjzjF5K8lNLXsl9SXAhvT7/IUO69vh6tUQXNTqWkuu2G6csFVGIsJfUNP2A3fZU3YFB3O3Zy3lWb+nkoygrXBULGtePeRbCrPg95e8Xl0SxZr3x8dY+y9UGpYJX+L6gFM7cZbH0mD0t+HnnML2/59aR6NzzKHu30ym/ADm1oLT1nsS2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e1f2c9c921b57a6cd4a852bc46edaa4a/c9b55/opensearch_result.webp 165w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/f2908/opensearch_result.webp 330w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/cc661/opensearch_result.webp 660w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/a66df/opensearch_result.webp 990w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/d33d4/opensearch_result.webp 1320w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/36ae5/opensearch_result.webp 1496w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e1f2c9c921b57a6cd4a852bc46edaa4a/04c57/opensearch_result.png 165w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/d9ecf/opensearch_result.png 330w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/1f083/opensearch_result.png 660w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/7a3d6/opensearch_result.png 990w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/78958/opensearch_result.png 1320w,\n/static/e1f2c9c921b57a6cd4a852bc46edaa4a/e4ee8/opensearch_result.png 1496w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e1f2c9c921b57a6cd4a852bc46edaa4a/1f083/opensearch_result.png\"\n            alt=\"image.png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>지인찬스 → N 사는 6천건으로 설정</p>\n</li>\n<li>\n<p>기본 1만건이지만, 설정으로 바꿀 수 있는 점 확인</p>\n<ul>\n<li>document 사이즈나 검색 빈도를 고려해서</li>\n<li>건수를 늘릴 수록 메모리 사용량이 많아져, 검색에 지장 갈 수 있으니 크게 잡지 않는게 좋은 점 확인</li>\n</ul>\n</li>\n<li>\n<p>OpenSearch의 근본인 Elastic Search도 찾아보아도 동일<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADE0lEQVR42m1UaU8TQRjubzHxmwotIKcgchg8SIwE/OIH/5KJV2LELyYm/gHxKArGRBNDRAFFK6XZ7R7dnT1mu0d328d3ZluCxNk8eWfenXnmPaeANqAwBVX1EFEYgXMO1/fh8yY8n0v4PIDr+Wg2Q2TtDrJOB2maoZPGuPtBx+3nFbzYZhCjoOkGmOMiy2gDbWy1WrAcD5bLYXsBLIKQcdZBQmRRSntofnJ0ul+BMYcIHURRJEmTOIZumKgpCjStjno9RxiGiOmf2CcQCpAuIl1IniVkiLTQI1fEj3a7LRVZlpJ1vrSMOQyO68KybViWDZukYZp0oQGz0UCjYUmp6To8z8sJXdeTN/QI2+0MBwdVbG1tY29vHzs7e4Qf2N3t4eexeY7vtGf/V0V6WBDxcwgidiKGYtx7+ATFkVlMTF/F8NhcF7O5HJ09ppvDyPg8SkMXcWPpNnxKYEG4FMcJRZWyl+VW3n/wGMXROUxdXEBxcEoeGDg//V8MDl/CueIErlxfzgl7Gc7jl8uHj55gYGweM1eWMDq5gOGJyxjsHj6JoZEZ9JUu4NrirZ6FnszYv4SrOHW6iBKRDJGL4uBJy0pD00eWn+0fJwtXuhYyJpNynHD16TMs37qD+YWbONM3hv6ByS6mJPpKk/KSXhzF/OriCkTFFEQHtFqpCCFlOE9KtXqISuUPZforXr0uE9alXBN4VcbLtTd4W36Pjc2PKK9voPxuE58+f8mzrOpUYywAD1N4QYIgbCEIAtSpsE3ToApgcAmiBrnvoZWIgqbOiUKJKGoibAbUit3CVjQbqk6HeExoSUKb4nqgWajRZYe6Bd1yYFERV5QGfikMvxWbpI3fKkOF8LNmgfnNnLBS1bBfUSCIHZ6gGaUwvAjf9Bg7dY7tmotDk9PDEcAgT1SLQ23wXBLqltAFaMZdC2uqhbrhQG/4ZFlEhBnVZQST2kmrq9J1TdOgqKpc66K/VdJ11wIOs6iO27IxCqbHYVDv2kEIN0rgEYIkgR/F1M/i1fHotfHBCI6fS3a05jI8Pj1rcZpKwr9+Sy47EkR/BAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c515bb7a15d9c1be4b82396593417ff9/c9b55/reference_elastic.webp 165w,\n/static/c515bb7a15d9c1be4b82396593417ff9/f2908/reference_elastic.webp 330w,\n/static/c515bb7a15d9c1be4b82396593417ff9/cc661/reference_elastic.webp 660w,\n/static/c515bb7a15d9c1be4b82396593417ff9/5ffe7/reference_elastic.webp 913w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c515bb7a15d9c1be4b82396593417ff9/04c57/reference_elastic.png 165w,\n/static/c515bb7a15d9c1be4b82396593417ff9/d9ecf/reference_elastic.png 330w,\n/static/c515bb7a15d9c1be4b82396593417ff9/1f083/reference_elastic.png 660w,\n/static/c515bb7a15d9c1be4b82396593417ff9/0eb6d/reference_elastic.png 913w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c515bb7a15d9c1be4b82396593417ff9/1f083/reference_elastic.png\"\n            alt=\"image.png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>대안은 scroll 과 search_after를 사용하면 가능한점 확인</p>\n<ul>\n<li>원리는 마지막 데이터의 고유 아이디와 인덱스 정보를 가지고, 마지막을 찾아가 그 위치(offset)부터 페이지 사이즈만큼 조회하도록 함.<br>\n<img src=\"https://prod-files-secure.s3.us-west-2.amazonaws.com/4af44c55-bb9f-4a14-af4e-55648b227811/05da9c9c-4705-4287-b082-43885ac9733a/image.png\" alt=\"image.png\"></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<h2>🗽 <strong>Result</strong></h2>\n</blockquote>\n<ul>\n<li>scroll 사용해서 페이지네이션 하도록 변경</li>\n<li>프론트개발 리드 분께서 이해 못하셔서 설명해드렸지만, 20년동안 처음 본다고 하셔서 아래 내용들을 가지고 납득시켜드린 좋은 경험도 함.\n<ul>\n<li>RDB와 차이점</li>\n<li>OpenSearch/elastic 공식 문서</li>\n<li>dev tool 과 play ground에서 테스트결과 첨부</li>\n<li>scoll 과 search_after이라는 대안</li>\n</ul>\n</li>\n</ul>","categories":["Computer Science"],"date":"October 11, 2024","description":"","id":"5ddbf650-af0f-5c49-9258-93ce167dff27","keywords":["OpenSearch","Elastic Search","inqury","pagination"],"slug":"/ComputerScience/maximum-inqury-count-of-opensearch/","title":"OpenSearch 최대 조회 건수 ","readingTime":{"text":"3 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["3262260831","948380417"],"slicesMap":{}}